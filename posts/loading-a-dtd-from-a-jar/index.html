<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Loading a DTD from a JAR | tomregan.github.io</title>
<meta name=keywords content><meta name=description content="Bundling resources into a jar file is a common way to deploy your Java application, useful because it makes the jar&rsquo;s resources available to retrieve via the classloader at runtime.
When loading XML, you can require DTD veirification, which is a means of validating the XML is gramatical. Hopefully everything up till now is old news.
I struggled trying to load XML from the classpath to also have the DTD load correctly."><meta name=author content><link rel=canonical href=https://tomregan.github.io/posts/loading-a-dtd-from-a-jar/><link crossorigin=anonymous href=/assets/css/stylesheet.2d57c2ec5c1393c947086a457dd198f941b9476b45ce2a2405529f16729999ae.css integrity="sha256-LVfC7FwTk8lHCGpFfdGY+UG5R2tFziokBVKfFnKZma4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomregan.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomregan.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomregan.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomregan.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomregan.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tomregan.github.io/posts/loading-a-dtd-from-a-jar/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Loading a DTD from a JAR"><meta property="og:description" content="Bundling resources into a jar file is a common way to deploy your Java application, useful because it makes the jar&rsquo;s resources available to retrieve via the classloader at runtime.
When loading XML, you can require DTD veirification, which is a means of validating the XML is gramatical. Hopefully everything up till now is old news.
I struggled trying to load XML from the classpath to also have the DTD load correctly."><meta property="og:type" content="article"><meta property="og:url" content="https://tomregan.github.io/posts/loading-a-dtd-from-a-jar/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-12-02T00:00:00+00:00"><meta property="article:modified_time" content="2013-12-02T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Loading a DTD from a JAR"><meta name=twitter:description content="Bundling resources into a jar file is a common way to deploy your Java application, useful because it makes the jar&rsquo;s resources available to retrieve via the classloader at runtime.
When loading XML, you can require DTD veirification, which is a means of validating the XML is gramatical. Hopefully everything up till now is old news.
I struggled trying to load XML from the classpath to also have the DTD load correctly."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomregan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Loading a DTD from a JAR","item":"https://tomregan.github.io/posts/loading-a-dtd-from-a-jar/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Loading a DTD from a JAR","name":"Loading a DTD from a JAR","description":"Bundling resources into a jar file is a common way to deploy your Java application, useful because it makes the jar\u0026rsquo;s resources available to retrieve via the classloader at runtime.\nWhen loading XML, you can require DTD veirification, which is a means of validating the XML is gramatical. Hopefully everything up till now is old news.\nI struggled trying to load XML from the classpath to also have the DTD load correctly.","keywords":[],"articleBody":"Bundling resources into a jar file is a common way to deploy your Java application, useful because it makes the jar’s resources available to retrieve via the classloader at runtime.\nWhen loading XML, you can require DTD veirification, which is a means of validating the XML is gramatical. Hopefully everything up till now is old news.\nI struggled trying to load XML from the classpath to also have the DTD load correctly. In the case of my old application the path to the DTD is specified in the XML as a relative path, and it’s assumed the document is on the filesystem.\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE MyApplication SYSTEM \"dtd/config.dtd\"\u003e ... Following some redesign, this is no longer the case. So how do we find config.dtd now that it’s on the classpath? It’s really simple once you know which components to use; the answers are here on Stack Overflow, and in more depth here at onjava.com.\nApplying this solution, I wrote a custom entity resolver which transforms dtd/config.dtd into the classpath resource path /dtd/config.dtd. For all other resources it does nothing, which is what I want.\nSAXBuilder builder = new SAXBuilder(true); builder.setEntityResolver(new EntityResolver() { @Override public InputSource resolveEntity(String publicId, String systemId) throws SAXException, IOException { if (systemId.endsWith(\"dtd/config.dtd\")) { return new InputSource(getClass().getResourceAsStream(\"/dtd/config.dtd\")); } return null; } }); If you haven’t come across entity resolvers, this problem seems a bit daunting, but it’s much simpler than it first appears.\n","wordCount":"238","inLanguage":"en","datePublished":"2013-12-02T00:00:00Z","dateModified":"2013-12-02T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomregan.github.io/posts/loading-a-dtd-from-a-jar/"},"publisher":{"@type":"Organization","name":"tomregan.github.io","logo":{"@type":"ImageObject","url":"https://tomregan.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomregan.github.io/ accesskey=h title="tomregan.github.io (Alt + H)">tomregan.github.io</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://tomregan.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://tomregan.github.io/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tomregan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://tomregan.github.io/posts/>Posts</a></div><h1 class=post-title>Loading a DTD from a JAR</h1><div class=post-meta><span title='2013-12-02 00:00:00 +0000 UTC'>2 December 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;238 words</div></header><div class=post-content><p>Bundling resources into a jar file is a common way to deploy your Java
application, useful because it makes the jar&rsquo;s resources available to
retrieve via the classloader at runtime.</p><p>When loading XML, you can require DTD veirification, which is a means of
validating the XML is gramatical. Hopefully everything up till now is old
news.</p><p>I struggled trying to load XML from the classpath to also have the DTD load
correctly. In the case of my old application the path to the DTD is specified
in the XML as a relative path, and it&rsquo;s assumed the document is on the
filesystem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE MyApplication SYSTEM &#34;dtd/config.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;config&gt;</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/config&gt;</span>
</span></span></code></pre></div><p>Following some redesign, this is no longer the case. So how do we find
<code>config.dtd</code> now that it&rsquo;s on the classpath? It&rsquo;s really simple once you know
which components to use; the answers are <a href=http://stackoverflow.com/a/155330>here on Stack Overflow</a>,
and in more depth <a href="http://www.onjava.com/pub/a/onjava/excerpt/java_xslt_ch5/index.html?page=5">here at onjava.com</a>.</p><p>Applying this solution, I wrote a custom entity resolver which transforms
<code>dtd/config.dtd</code> into the classpath resource path <code>/dtd/config.dtd</code>. For
all other resources it does nothing, which is what I want.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>SAXBuilder builder <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SAXBuilder(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    builder.<span style=color:#a6e22e>setEntityResolver</span>(<span style=color:#66d9ef>new</span> EntityResolver() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> InputSource <span style=color:#a6e22e>resolveEntity</span>(String publicId, String systemId) <span style=color:#66d9ef>throws</span> SAXException, IOException {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (systemId.<span style=color:#a6e22e>endsWith</span>(<span style=color:#e6db74>&#34;dtd/config.dtd&#34;</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> InputSource(getClass().<span style=color:#a6e22e>getResourceAsStream</span>(<span style=color:#e6db74>&#34;/dtd/config.dtd&#34;</span>));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>If you haven&rsquo;t come across entity resolvers, this problem seems a bit daunting,
but it&rsquo;s much simpler than it first appears.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tomregan.github.io/>tomregan.github.io</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>