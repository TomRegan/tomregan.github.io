<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fixing a Permissions Error Opening a Semaphore | tomregan.github.io</title>
<meta name=keywords content><meta name=description content='Today I spent a couple of hours getting semaphores to work.
I was opening a semaphore like this:
{% highlight c %} if (SEM_FAILED == (CACHE_LOCK = sem_open("/cache_lock", O_CREAT, 0660, 1))) { printf(&ldquo;error opening semphore: %i\n&rdquo;, errno); return -1; /* error creating semaphore */ } {% endhighlight %}
This runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets errno to EACCESS (13). Whatever you might expect, this fact alone did not allow me to figure out the cause of the problem.'><meta name=author content><link rel=canonical href=https://tomregan.github.io/posts/fixing-a-permissions-error-opening-a-semaphore/><link crossorigin=anonymous href=/assets/css/stylesheet.2d57c2ec5c1393c947086a457dd198f941b9476b45ce2a2405529f16729999ae.css integrity="sha256-LVfC7FwTk8lHCGpFfdGY+UG5R2tFziokBVKfFnKZma4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomregan.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomregan.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomregan.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomregan.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomregan.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tomregan.github.io/posts/fixing-a-permissions-error-opening-a-semaphore/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Fixing a Permissions Error Opening a Semaphore"><meta property="og:description" content='Today I spent a couple of hours getting semaphores to work.
I was opening a semaphore like this:
{% highlight c %} if (SEM_FAILED == (CACHE_LOCK = sem_open("/cache_lock", O_CREAT, 0660, 1))) { printf(&ldquo;error opening semphore: %i\n&rdquo;, errno); return -1; /* error creating semaphore */ } {% endhighlight %}
This runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets errno to EACCESS (13). Whatever you might expect, this fact alone did not allow me to figure out the cause of the problem.'><meta property="og:type" content="article"><meta property="og:url" content="https://tomregan.github.io/posts/fixing-a-permissions-error-opening-a-semaphore/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2012-10-06T00:00:00+00:00"><meta property="article:modified_time" content="2012-10-06T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fixing a Permissions Error Opening a Semaphore"><meta name=twitter:description content='Today I spent a couple of hours getting semaphores to work.
I was opening a semaphore like this:
{% highlight c %} if (SEM_FAILED == (CACHE_LOCK = sem_open("/cache_lock", O_CREAT, 0660, 1))) { printf(&ldquo;error opening semphore: %i\n&rdquo;, errno); return -1; /* error creating semaphore */ } {% endhighlight %}
This runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets errno to EACCESS (13). Whatever you might expect, this fact alone did not allow me to figure out the cause of the problem.'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomregan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Fixing a Permissions Error Opening a Semaphore","item":"https://tomregan.github.io/posts/fixing-a-permissions-error-opening-a-semaphore/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fixing a Permissions Error Opening a Semaphore","name":"Fixing a Permissions Error Opening a Semaphore","description":"Today I spent a couple of hours getting semaphores to work.\nI was opening a semaphore like this:\n{% highlight c %} if (SEM_FAILED == (CACHE_LOCK = sem_open(\u0026quot;/cache_lock\u0026quot;, O_CREAT, 0660, 1))) { printf(\u0026ldquo;error opening semphore: %i\\n\u0026rdquo;, errno); return -1; /* error creating semaphore */ } {% endhighlight %}\nThis runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets errno to EACCESS (13). Whatever you might expect, this fact alone did not allow me to figure out the cause of the problem.","keywords":[],"articleBody":"Today I spent a couple of hours getting semaphores to work.\nI was opening a semaphore like this:\n{% highlight c %} if (SEM_FAILED == (CACHE_LOCK = sem_open(\"/cache_lock\", O_CREAT, 0660, 1))) { printf(“error opening semphore: %i\\n”, errno); return -1; /* error creating semaphore */ } {% endhighlight %}\nThis runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets errno to EACCESS (13). Whatever you might expect, this fact alone did not allow me to figure out the cause of the problem.\nIt turns out the name I’d chosen isn’t allowed. I couldn’t find the rules that expressly state this, or even hinted that it might be the case, but I found when I changed the name from ‘/cache_lock’ to ‘/lock’ on a whim, it worked. Apparantly, underscores are not cool with Linux kernel developers.\nDuring my Googling I found the following question which put me on the right track.\n","wordCount":"155","inLanguage":"en","datePublished":"2012-10-06T00:00:00Z","dateModified":"2012-10-06T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomregan.github.io/posts/fixing-a-permissions-error-opening-a-semaphore/"},"publisher":{"@type":"Organization","name":"tomregan.github.io","logo":{"@type":"ImageObject","url":"https://tomregan.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomregan.github.io/ accesskey=h title="tomregan.github.io (Alt + H)">tomregan.github.io</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://tomregan.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://tomregan.github.io/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tomregan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://tomregan.github.io/posts/>Posts</a></div><h1 class=post-title>Fixing a Permissions Error Opening a Semaphore</h1><div class=post-meta>&lt;span title='2012-10-06 00:00:00 +0000 UTC'>October 6, 2012&lt;/span>&amp;nbsp;·&amp;nbsp;1 min&amp;nbsp;·&amp;nbsp;155 words</div></header><div class=post-content><p>Today I spent a couple of hours getting semaphores to work.</p><p><img loading=lazy src=https://farm1.staticflickr.com/177/403268783_bd644e1b0a.jpg alt title="semaphore by brapps, on Flickr"></p><p>I was opening a semaphore like this:</p><p>{% highlight c %}
if (SEM_FAILED == (CACHE_LOCK = sem_open("/cache_lock", O_CREAT, 0660, 1))) {
printf(&ldquo;error opening semphore: %i\n&rdquo;, errno);
return -1; /* error creating semaphore */
}
{% endhighlight %}</p><p>This runs fine on my Mac, but fails on an Ubuntu machine. On failure it sets
<code>errno</code> to <code>EACCESS (13)</code>. Whatever you might expect, this fact alone did
not allow me to figure out the cause of the problem.</p><p><img loading=lazy src=/assets/images/2012-10-06-fixing-a-permissions-error-opening-a-semaphore/read-all-the-things.png alt></p><p>It turns out the name I&rsquo;d chosen isn&rsquo;t allowed. I couldn&rsquo;t find the rules
that expressly state this, or even hinted that it might be the case, but
I found when I changed the name from &lsquo;/cache_lock&rsquo; to &lsquo;/lock&rsquo; on a whim,
it worked. Apparantly, underscores are not cool with Linux kernel developers.</p><p>During my Googling I found <a href=http://stackoverflow.com/questions/10409901/sem-open-causes-illegal-seek-error>the following question</a>
which put me on the right track.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tomregan.github.io/>tomregan.github.io</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>