<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Unit Testing in C with Check | tomregan.github.io</title>
<meta name=keywords content><meta name=description content="###Pushy I&rsquo;ve been developing a cheerfully indolent little HTTP server for some time now, as one of those &rsquo;learn-more-c&rsquo;, &rsquo;learn-TDD&rsquo; projects that I imagine nearly everyone has lying around, half neglected.
You can see the code for pushy on github.
I&rsquo;ve also been familiarizing myself with the HTTP RFCs as I go, so I was planning to add a 414 response^[1] to pushy&rsquo;s repertoire, which I reckoned would take me about 30 minutes, but I have the TDD policy on this project, so naturally I can&rsquo;t write a line of code until there&rsquo;s a failing test."><meta name=author content><link rel=canonical href=https://tomregan.github.io/posts/unit-testing-in-c-with-check/><link crossorigin=anonymous href=/assets/css/stylesheet.2d57c2ec5c1393c947086a457dd198f941b9476b45ce2a2405529f16729999ae.css integrity="sha256-LVfC7FwTk8lHCGpFfdGY+UG5R2tFziokBVKfFnKZma4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomregan.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomregan.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomregan.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomregan.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomregan.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tomregan.github.io/posts/unit-testing-in-c-with-check/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Unit Testing in C with Check"><meta property="og:description" content="###Pushy I&rsquo;ve been developing a cheerfully indolent little HTTP server for some time now, as one of those &rsquo;learn-more-c&rsquo;, &rsquo;learn-TDD&rsquo; projects that I imagine nearly everyone has lying around, half neglected.
You can see the code for pushy on github.
I&rsquo;ve also been familiarizing myself with the HTTP RFCs as I go, so I was planning to add a 414 response^[1] to pushy&rsquo;s repertoire, which I reckoned would take me about 30 minutes, but I have the TDD policy on this project, so naturally I can&rsquo;t write a line of code until there&rsquo;s a failing test."><meta property="og:type" content="article"><meta property="og:url" content="https://tomregan.github.io/posts/unit-testing-in-c-with-check/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2012-12-09T00:00:00+00:00"><meta property="article:modified_time" content="2012-12-09T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Unit Testing in C with Check"><meta name=twitter:description content="###Pushy I&rsquo;ve been developing a cheerfully indolent little HTTP server for some time now, as one of those &rsquo;learn-more-c&rsquo;, &rsquo;learn-TDD&rsquo; projects that I imagine nearly everyone has lying around, half neglected.
You can see the code for pushy on github.
I&rsquo;ve also been familiarizing myself with the HTTP RFCs as I go, so I was planning to add a 414 response^[1] to pushy&rsquo;s repertoire, which I reckoned would take me about 30 minutes, but I have the TDD policy on this project, so naturally I can&rsquo;t write a line of code until there&rsquo;s a failing test."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomregan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Unit Testing in C with Check","item":"https://tomregan.github.io/posts/unit-testing-in-c-with-check/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Unit Testing in C with Check","name":"Unit Testing in C with Check","description":"###Pushy I\u0026rsquo;ve been developing a cheerfully indolent little HTTP server for some time now, as one of those \u0026rsquo;learn-more-c\u0026rsquo;, \u0026rsquo;learn-TDD\u0026rsquo; projects that I imagine nearly everyone has lying around, half neglected.\nYou can see the code for pushy on github.\nI\u0026rsquo;ve also been familiarizing myself with the HTTP RFCs as I go, so I was planning to add a 414 response^[1] to pushy\u0026rsquo;s repertoire, which I reckoned would take me about 30 minutes, but I have the TDD policy on this project, so naturally I can\u0026rsquo;t write a line of code until there\u0026rsquo;s a failing test.","keywords":[],"articleBody":"###Pushy I’ve been developing a cheerfully indolent little HTTP server for some time now, as one of those ’learn-more-c’, ’learn-TDD’ projects that I imagine nearly everyone has lying around, half neglected.\nYou can see the code for pushy on github.\nI’ve also been familiarizing myself with the HTTP RFCs as I go, so I was planning to add a 414 response^[1] to pushy’s repertoire, which I reckoned would take me about 30 minutes, but I have the TDD policy on this project, so naturally I can’t write a line of code until there’s a failing test. I’m on a new machine, so I need to install Check.\nLet the games commence.\n###Install MacPorts\nMacPorts is available from the MacPorts project website. Once you have this, installing Check should be as simple as port install check.\n###Get the tutorial project\nYou’ll be pleased to know that Check comes with a wildly overcomplicated tutorial.\nOn my system the Check install includes a set of tutorial files in /opt/local/share/doc/check/example. If you don’t find anything here it should be possible to query your package manager, for instance port contents check, or rpm -ql , dpkg -L , depending on your poison.\nCreate a working directory and copy the tutorial files there:\nmkdir check-tutorial cp -r /opt/local/share/doc/check/example check-tutorial/ ###Build the project\nThat’s easy, isn’t it? I checked the README, and saw I needed to grab the following dependencies:\nAutoconf Automake Libtool And then it should be a case of:\nautoreconf --install ./configure make make check So, I gave that a spin:\ntom@binky:check-tutorial:$ autoreconf --install glibtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and glibtoolize: rerunning glibtoolize, to keep the correct libtool macros in-tree. glibtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am. automake: warnings are treated as errors /opt/local/share/automake-1.12/am/ltlibrary.am: warning: 'libmoney.la': linking libtool libraries using a non-POSIX /opt/local/share/automake-1.12/am/ltlibrary.am: archiver requires 'AM_PROG_AR' in 'configure.ac' src/Makefile.am:3: while processing Libtool library 'libmoney.la' tests/Makefile.am:5: warning: compiling 'check_money.c' with per-target flags requires 'AM_PROG_CC_C_O' in 'configure.ac' autoreconf: automake failed with exit status: 1 And fell very much at the first hurdle. Still, those are some sensible errors so it should be easy to fix. First I added the missing macros, as directed by the output, which led to the following changes to Makefile.am:\n{% highlight diff %} — /opt/local/share/doc/check/example/Makefile.am 2012-08-10 22:56:02.000000000 +0100 +++ Makefile.am 2012-08-12 15:21:39.000000000 +0100 @@ -1,5 +1,3 @@\nProcess this file with automake to produce Makefile.in +SUBDIRS = src . tests + +ACLOCAL_AMFLAGS = -I m4 -SUBDIRS = src . tests {% endhighlight %}\nI also added AC_CONFIG_MACRO_DIR([m4]) to configure.ac and created the corresponding directory in the project:\ntom@binky:check-tutorial:$ mkdir m4 Now I get:\ntom@binky:check-tutorial:$ autoreconf --install ... /opt/local/share/automake-1.12/am/ltlibrary.am: archiver requires 'AM_PROG_AR' in 'configure.ac' So I add the final macro to configure.ac which results in the following changes:\n{% highlight diff %} — /opt/local/share/doc/check/example/configure.ac 2012-08-10 22:56:02.000000000 +0100 +++ configure.ac 2012-08-12 15:24:38.000000000 +0100 @@ -10,16 +10,13 @@\nplace to put some extra build scripts installed AC_CONFIG_AUX_DIR([build-aux])\n+AC_CONFIG_MACRO_DIR([m4]) +\nfairly severe build strictness change foreign to gnu or gnits to comply with gnu standards AM_INIT_AUTOMAKE([-Wall -Werror foreign 1.9.6])\nChecks for programs. +AM_PROG_CC_C_O -AC_PROG_CC AC_PROG_LIBTOOL +AM_PROG_AR\nChecks for libraries. {% endhighlight %}\nAnd finally it passes this step.\nThe next instruction is ./configure, which in my experience is always a one-stop-shop for merriment. It wasn’t too bad in this instance.\nchecking for check - version \u003e= 0.8.2... no *** Could not run check test program, checking why... *** The test program failed to compile or link. See the file config.log for *** the exact error that occured. configure: error: check not found This is to be expected, because my environment doesn’t know about the includes MacPorts installs under /opt. To fix, I first check the variable C_INCLUDE_PATH is unset:\necho $C_INCLUDE_PATH And then set it:\nexport C_INCLUDE_PATH=/opt/local/include If it already has some value, you should prepend the new path to the old, i.e.\nexport C_INCLUDE_PATH=/opt/local/include:$C_INCLUDE_PATH And then, run ./configure a final time. Next, make. If I were a betting man I’d put money on the linker having a great big episode.\ntom@binky:check-tutorial:$ make; make check ... /bin/sh ../libtool --tag=CC --mode=link gcc -g -O2 -o check_money check_money-check_money.o ../src/libmoney.la -lcheck libtool: link: gcc -g -O2 -o .libs/check_money check_money-check_money.o ../src/.libs/libmoney.dylib -lcheck ld: library not found for -lcheck collect2: ld returned 1 exit status make[2]: *** [check_money] Error 1 make[1]: *** [check-am] Error 2 make: *** [check-recursive] Error 1 I love it when I’m right. No, really. Love it.\nSo the most useful line in there is ld: library not found for -lcheck, which tells me the linker (ld) can’t find libcheck. Because I’m using a Mac I know that I’m looking for the .dylib files that were installed with Check. On linux I expect they would be .so files. In my case these happen to be in /opt/local/lib, so I need to make the environment aware of this location by setting LIBRARY_PATH (linux: LD_LIBRARY_PATH):\nexport LIBRARY_PATH=/opt/local/lib And finally:\ntom@binky:check-tutorial:$ make check Making check in src ... Running suite(s): Money 100%: Checks: 3, Failures: 0, Errors: 0 PASS: check_money ============= 1 test passed ============= Job done.\nWhy’s it so painful? The tutorial fails at the first step and it can be hard to understand why. I’ve never had the pleasure of using autotools, but I’m beginning to see why there’s some anti-gnu sentiment in the Unix-sphere. It’s a tremendously complicated build for a very, very simple project.\nIt doesn’t help that many of the links to documentation on the Check project page are broken.\nI happen to think that a test framework should be independent of the build system (you may say I’m a dreamer), so I’m going to pursue this to some sort of logical, probably painful, conclusion.\n###What have we achieved? Well, nothing that I set out to achieve, which was having a working test suite so I can add a simple feature to my server. Expect a Part Deux in the near-ish future.\n[1] and yes, this is related to a buffer over-run bug, thank you for asking.\n","wordCount":"994","inLanguage":"en","datePublished":"2012-12-09T00:00:00Z","dateModified":"2012-12-09T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomregan.github.io/posts/unit-testing-in-c-with-check/"},"publisher":{"@type":"Organization","name":"tomregan.github.io","logo":{"@type":"ImageObject","url":"https://tomregan.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomregan.github.io/ accesskey=h title="tomregan.github.io (Alt + H)">tomregan.github.io</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://tomregan.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://tomregan.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tomregan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://tomregan.github.io/posts/>Posts</a></div><h1 class=post-title>Unit Testing in C with Check</h1><div class=post-meta><span title='2012-12-09 00:00:00 +0000 UTC'>9 December 2012</span>&nbsp;·&nbsp;994 words</div></header><div class=post-content><p>###Pushy
I&rsquo;ve been developing a cheerfully indolent little HTTP server for some
time now, as one of those &rsquo;learn-more-c&rsquo;, &rsquo;learn-TDD&rsquo; projects that
I imagine nearly everyone has lying around, half neglected.</p><p>You can see the code for <a href=https://github.com/TomRegan/pushy>pushy on github</a>.</p><p>I&rsquo;ve also been familiarizing myself with the HTTP RFCs as I go, so I was
planning to add a <a id=reverse-pooky></a><a href=http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.15>414 response</a>^[<a href=#pookie>1</a>]
to pushy&rsquo;s repertoire, which I reckoned
would take me about 30 minutes, but I have the TDD policy on this
project, so <em>naturally</em> I can&rsquo;t write a line of code until there&rsquo;s
a failing test. I&rsquo;m on a new machine, so I need to install
<a href=http://check.sourceforge.net/>Check</a>.</p><p>Let the games commence.</p><p>###Install MacPorts</p><p>MacPorts is available from the <a href=http://www.macports.org/>MacPorts project website</a>.
Once you have this, installing Check should be as simple as <code>port install check</code>.</p><p>###Get the tutorial project</p><p>You&rsquo;ll be pleased to know that Check comes with a <em>wildly</em> overcomplicated
tutorial.</p><p>On my system the Check install includes a set of tutorial files in
<code>/opt/local/share/doc/check/example</code>. If you don&rsquo;t find anything here
it should be possible to query your package manager, for instance
<code>port contents check</code>, or <code>rpm -ql &lt;package-name></code>,
<code>dpkg -L &lt;package-name></code>, depending on your poison.</p><p>Create a working directory and copy the tutorial files there:</p><pre><code>mkdir check-tutorial
cp -r /opt/local/share/doc/check/example check-tutorial/
</code></pre><p>###Build the project</p><p>That&rsquo;s easy, isn&rsquo;t it? I checked the README, and saw I needed to
grab the following dependencies:</p><ul><li>Autoconf</li><li>Automake</li><li>Libtool</li></ul><p>And then it should be a case of:</p><pre><code>autoreconf --install
./configure
make
make check
</code></pre><p>So, I gave that a spin:</p><pre><code>tom@binky:check-tutorial:$ autoreconf --install
glibtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.ac and
glibtoolize: rerunning glibtoolize, to keep the correct libtool macros in-tree.
glibtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.
automake: warnings are treated as errors
/opt/local/share/automake-1.12/am/ltlibrary.am: warning: 'libmoney.la': linking libtool libraries using a non-POSIX
/opt/local/share/automake-1.12/am/ltlibrary.am: archiver requires 'AM_PROG_AR' in 'configure.ac'
src/Makefile.am:3:   while processing Libtool library 'libmoney.la'
tests/Makefile.am:5: warning: compiling 'check_money.c' with per-target flags requires 'AM_PROG_CC_C_O' in 'configure.ac'
autoreconf: automake failed with exit status: 1
</code></pre><p>And fell very much at the first hurdle. Still, those are some sensible
errors so it should be easy to fix. First I added the missing macros, as
directed by the output, which led to the following changes to <code>Makefile.am</code>:</p><p>{% highlight diff %}
&mdash; /opt/local/share/doc/check/example/Makefile.am 2012-08-10 22:56:02.000000000 +0100
+++ Makefile.am 2012-08-12 15:21:39.000000000 +0100
@@ -1,5 +1,3 @@</p><h2 id=process-this-file-with-automake-to-produce-makefilein>Process this file with automake to produce Makefile.in<a hidden class=anchor aria-hidden=true href=#process-this-file-with-automake-to-produce-makefilein>#</a></h2><p>+SUBDIRS = src . tests
+
+ACLOCAL_AMFLAGS = -I m4
-SUBDIRS = src . tests
{% endhighlight %}</p><p>I also added <code>AC_CONFIG_MACRO_DIR([m4])</code> to <code>configure.ac</code> and created
the corresponding directory in the project:</p><pre><code>tom@binky:check-tutorial:$ mkdir m4
</code></pre><p>Now I get:</p><pre><code>tom@binky:check-tutorial:$ autoreconf --install
...
/opt/local/share/automake-1.12/am/ltlibrary.am: archiver requires 'AM_PROG_AR' in 'configure.ac'
</code></pre><p>So I add the final macro to <code>configure.ac</code> which results in the
following changes:</p><p>{% highlight diff %}
&mdash; /opt/local/share/doc/check/example/configure.ac 2012-08-10 22:56:02.000000000 +0100
+++ configure.ac 2012-08-12 15:24:38.000000000 +0100
@@ -10,16 +10,13 @@</p><h1 id=place-to-put-some-extra-build-scripts-installed>place to put some extra build scripts installed<a hidden class=anchor aria-hidden=true href=#place-to-put-some-extra-build-scripts-installed>#</a></h1><p>AC_CONFIG_AUX_DIR([build-aux])</p><p>+AC_CONFIG_MACRO_DIR([m4])
+</p><h1 id=fairly-severe-build-strictness>fairly severe build strictness<a hidden class=anchor aria-hidden=true href=#fairly-severe-build-strictness>#</a></h1><h1 id=change-foreign-to-gnu-or-gnits-to-comply-with-gnu-standards>change foreign to gnu or gnits to comply with gnu standards<a hidden class=anchor aria-hidden=true href=#change-foreign-to-gnu-or-gnits-to-comply-with-gnu-standards>#</a></h1><p>AM_INIT_AUTOMAKE([-Wall -Werror foreign 1.9.6])</p><h1 id=checks-for-programs>Checks for programs.<a hidden class=anchor aria-hidden=true href=#checks-for-programs>#</a></h1><p>+AM_PROG_CC_C_O
-AC_PROG_CC
AC_PROG_LIBTOOL
+AM_PROG_AR</p><h1 id=checks-for-libraries>Checks for libraries.<a hidden class=anchor aria-hidden=true href=#checks-for-libraries>#</a></h1><p>{% endhighlight %}</p><p>And finally it passes this step.</p><p>The next instruction is <code>./configure</code>, which in my experience is <em>always</em>
a one-stop-shop for merriment. It wasn&rsquo;t too bad in this instance.</p><pre><code>checking for check - version &gt;= 0.8.2... no
*** Could not run check test program, checking why...
*** The test program failed to compile or link. See the file config.log for
*** the exact error that occured.
configure: error: check not found
</code></pre><p>This is to be expected, because my environment doesn&rsquo;t know about the
includes MacPorts installs under <code>/opt</code>. To fix, I first check the variable
<code>C_INCLUDE_PATH</code> is unset:</p><pre><code>echo $C_INCLUDE_PATH
</code></pre><p>And then set it:</p><pre><code>export C_INCLUDE_PATH=/opt/local/include
</code></pre><p>If it already has some value, you should prepend the new path to the old,
i.e.</p><pre><code>export C_INCLUDE_PATH=/opt/local/include:$C_INCLUDE_PATH
</code></pre><p>And then, run <code>./configure</code> a final time. Next, <code>make</code>. If I were a betting
man I&rsquo;d put money on the linker having a great big episode.</p><pre><code>tom@binky:check-tutorial:$ make; make check
...
/bin/sh ../libtool --tag=CC   --mode=link gcc  -g -O2   -o check_money check_money-check_money.o ../src/libmoney.la -lcheck 
libtool: link: gcc -g -O2 -o .libs/check_money check_money-check_money.o  ../src/.libs/libmoney.dylib -lcheck
ld: library not found for -lcheck
collect2: ld returned 1 exit status
make[2]: *** [check_money] Error 1
make[1]: *** [check-am] Error 2
make: *** [check-recursive] Error 1
</code></pre><p>I love it when I&rsquo;m right. No, really. Love it.</p><p>So the most useful line in there is <code>ld: library not found for -lcheck</code>,
which tells me the linker (<code>ld</code>) can&rsquo;t find <code>libcheck</code>. Because I&rsquo;m using
a Mac I know that I&rsquo;m looking for the <code>.dylib</code> files that were installed
with Check. On linux I expect they would be <code>.so</code> files. In my case
these happen to be in <code>/opt/local/lib</code>, so I need to make the environment
aware of this location by setting <code>LIBRARY_PATH</code> (linux: <code>LD_LIBRARY_PATH</code>):</p><pre><code>export LIBRARY_PATH=/opt/local/lib
</code></pre><p>And finally:</p><pre><code>tom@binky:check-tutorial:$ make check
Making check in src
...
Running suite(s): Money
100%: Checks: 3, Failures: 0, Errors: 0
PASS: check_money
=============
1 test passed
=============
</code></pre><p>Job done.</p><h3 id=whys-it-so-painful>Why&rsquo;s it so painful?<a hidden class=anchor aria-hidden=true href=#whys-it-so-painful>#</a></h3><p>The tutorial fails at the first step and it can be hard to understand why.
I&rsquo;ve never had the pleasure of using autotools, but I&rsquo;m beginning to see why there&rsquo;s some
anti-gnu sentiment in the Unix-sphere. It&rsquo;s a tremendously complicated
build for a very, very simple project.</p><p>It doesn&rsquo;t help that many of the links to documentation on the Check
project page are <a href=http://check.sourceforge.net/doc/check_html/index.html>broken</a>.</p><p>I happen to think
that a test framework should be independent of the build system
(<a href="http://www.youtube.com/watch?v=yRhq-yO1KN8">you may say I&rsquo;m a dreamer</a>),
so I&rsquo;m going to pursue this to some sort of logical, probably painful,
conclusion.</p><p>###What have we achieved?
Well, nothing that I set out to achieve, which was having a working
test suite so I can add a simple feature to my server. Expect a
<em><a href="http://www.youtube.com/watch?v=hEc-9hIdK0E">Part Deux</a></em>
in the near-ish future.</p><p><a id=pookie></a><sup>[<a href=#reverse-pooky>1</a>]</sup> <em>and yes, this is related to a buffer over-run bug, thank you for asking.</em></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tomregan.github.io/>tomregan.github.io</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>