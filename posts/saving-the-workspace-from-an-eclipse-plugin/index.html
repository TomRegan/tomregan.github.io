<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Saving the Workspace from an Eclipse Plugin | tomregan.github.io</title>
<meta name=keywords content><meta name=description content="Since I&rsquo;m going to the trouble of making a plugin for Eclipse, I thought I may as well try and make if look and feel a bit Eclipsy, so when it came to writing an export feature to bundle the user&rsquo;s project, I decided it would be a jolly good thing if the user got a dialog to prompt them to save their changes, much as when you run an application in Eclipse."><meta name=author content><link rel=canonical href=https://tomregan.github.io/posts/saving-the-workspace-from-an-eclipse-plugin/><link crossorigin=anonymous href=/assets/css/stylesheet.2d57c2ec5c1393c947086a457dd198f941b9476b45ce2a2405529f16729999ae.css integrity="sha256-LVfC7FwTk8lHCGpFfdGY+UG5R2tFziokBVKfFnKZma4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tomregan.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomregan.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomregan.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tomregan.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tomregan.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tomregan.github.io/posts/saving-the-workspace-from-an-eclipse-plugin/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Saving the Workspace from an Eclipse Plugin"><meta property="og:description" content="Since I&rsquo;m going to the trouble of making a plugin for Eclipse, I thought I may as well try and make if look and feel a bit Eclipsy, so when it came to writing an export feature to bundle the user&rsquo;s project, I decided it would be a jolly good thing if the user got a dialog to prompt them to save their changes, much as when you run an application in Eclipse."><meta property="og:type" content="article"><meta property="og:url" content="https://tomregan.github.io/posts/saving-the-workspace-from-an-eclipse-plugin/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2012-09-17T00:00:00+00:00"><meta property="article:modified_time" content="2012-09-17T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Saving the Workspace from an Eclipse Plugin"><meta name=twitter:description content="Since I&rsquo;m going to the trouble of making a plugin for Eclipse, I thought I may as well try and make if look and feel a bit Eclipsy, so when it came to writing an export feature to bundle the user&rsquo;s project, I decided it would be a jolly good thing if the user got a dialog to prompt them to save their changes, much as when you run an application in Eclipse."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomregan.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Saving the Workspace from an Eclipse Plugin","item":"https://tomregan.github.io/posts/saving-the-workspace-from-an-eclipse-plugin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Saving the Workspace from an Eclipse Plugin","name":"Saving the Workspace from an Eclipse Plugin","description":"Since I\u0026rsquo;m going to the trouble of making a plugin for Eclipse, I thought I may as well try and make if look and feel a bit Eclipsy, so when it came to writing an export feature to bundle the user\u0026rsquo;s project, I decided it would be a jolly good thing if the user got a dialog to prompt them to save their changes, much as when you run an application in Eclipse.","keywords":[],"articleBody":"Since I’m going to the trouble of making a plugin for Eclipse, I thought I may as well try and make if look and feel a bit Eclipsy, so when it came to writing an export feature to bundle the user’s project, I decided it would be a jolly good thing if the user got a dialog to prompt them to save their changes, much as when you run an application in Eclipse.\nThe following method will check each window for open editors, check if the editor has unsaved content, and if one does present a dialog.\n{% highlight java %} private boolean checkForUnsavedFiles() { IWorkbenchWindow[] windows = PlatformUI.getWorkbench().getWorkbenchWindows(); for (IWorkbenchWindow window : windows) { IWorkbenchPage page = window.getActivePage(); IEditorReference[] references = page.getEditorReferences(); for(IEditorReference reference : references) { if (reference.isDirty()) { int dialogResponse = unsavedFilesDialog.open(); if (dialogResponse == YES) { page.saveAllEditors(false); return true; } else if (dialogResponse == NO) { return true; } return false; } } } return true; } {% endhighlight %}\nI also think it’s a jolly good thing that users are bullied and cajoled until their code compiles correctly and efficiently (because I’m a hypocrite), so to that end I’ve also written some code to check the project for annotations (Eclipse refers to errors, bookmarks – any mark you see in the left editor gutter – as an annotation) and to determine if any of those annotations represent errors (as opposed to warnings, or something else all-together).\nThis method searches a list of annotations from the project, checks them for severity, and if any errors are found shows a dialog.\n{% highlight java %} private boolean checkForCompileErrors(IJavaProject selectedProject) { IProject project = selectedProject.getProject(); IMarker[] markers = null; try { markers = project.findMarkers(IMarker.PROBLEM, true, IResource.DEPTH_INFINITE); for (IMarker marker : markers) { Integer severity = (Integer) marker.getAttribute(IMarker.SEVERITY); if (severity != null \u0026\u0026 severity \u003e= IMarker.SEVERITY_ERROR) { int dialogResponse = compilationErrorsDialog.open(); if (dialogResponse == YES) { return true; } return false; } } } catch (CoreException e) { return true; } return true; } {% endhighlight %}\nI implemented my own dialogs, but it’s worth being aware of the pre-baked JFace dialogs provided; there’s a list here.\nHere are a couple of links to the more interesting pages of Eclipse documentation:\nDialogs in Eclipse IMarker interface (used to check for errors) ","wordCount":"382","inLanguage":"en","datePublished":"2012-09-17T00:00:00Z","dateModified":"2012-09-17T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://tomregan.github.io/posts/saving-the-workspace-from-an-eclipse-plugin/"},"publisher":{"@type":"Organization","name":"tomregan.github.io","logo":{"@type":"ImageObject","url":"https://tomregan.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tomregan.github.io/ accesskey=h title="tomregan.github.io (Alt + H)">tomregan.github.io</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://tomregan.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://tomregan.github.io/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tomregan.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://tomregan.github.io/posts/>Posts</a></div><h1 class=post-title>Saving the Workspace from an Eclipse Plugin</h1><div class=post-meta><span title='2012-09-17 00:00:00 +0000 UTC'>17 September 2012</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;382 words</div></header><div class=post-content><p>Since I&rsquo;m going to the trouble of making a plugin for Eclipse,
I thought I may as well try and make if look and feel a bit
Eclipsy, so when it came to writing an export feature to bundle the
user&rsquo;s project, I decided it would be a jolly good thing if the user
got a dialog to prompt them to save their changes, much as when you run
an application in Eclipse.</p><p>The following method will check each window for open editors, check if
the editor has unsaved content, and if one does present a dialog.</p><p>{% highlight java %}
private boolean checkForUnsavedFiles() {
IWorkbenchWindow[] windows = PlatformUI.getWorkbench().getWorkbenchWindows();
for (IWorkbenchWindow window : windows) {
IWorkbenchPage page = window.getActivePage();
IEditorReference[] references = page.getEditorReferences();
for(IEditorReference reference : references) {
if (reference.isDirty()) {
int dialogResponse = unsavedFilesDialog.open();
if (dialogResponse == YES) {
page.saveAllEditors(false);
return true;
} else if (dialogResponse == NO) {
return true;
}
return false;
}
}
}
return true;
}
{% endhighlight %}</p><p>I also think it&rsquo;s a jolly good thing that users are bullied and cajoled
until their code compiles correctly and efficiently (because I&rsquo;m a
hypocrite), so to that end I&rsquo;ve also written some code to check the project
for annotations (Eclipse refers to errors, bookmarks &ndash; any mark you see
in the left editor gutter &ndash; as an annotation) and to determine if any of
those annotations represent errors (as opposed to warnings, or something else
all-together).</p><p>This method searches a list of annotations from the project, checks them
for severity, and if any errors are found shows a dialog.</p><p>{% highlight java %}
private boolean checkForCompileErrors(IJavaProject selectedProject) {
IProject project = selectedProject.getProject();
IMarker[] markers = null;
try {
markers = project.findMarkers(IMarker.PROBLEM, true, IResource.DEPTH_INFINITE);
for (IMarker marker : markers) {
Integer severity = (Integer) marker.getAttribute(IMarker.SEVERITY);
if (severity != null && severity >= IMarker.SEVERITY_ERROR) {
int dialogResponse = compilationErrorsDialog.open();
if (dialogResponse == YES) {
return true;
}
return false;
}
}
} catch (CoreException e) {
return true;
}
return true;
}
{% endhighlight %}</p><p>I implemented my own dialogs, but it&rsquo;s worth being aware of the pre-baked
JFace dialogs provided; there&rsquo;s a list <a href=https://sureshkrishna.wordpress.com/2008/03/15/jface-dialogs-which-one-is-right-for-you/>here</a>.</p><p>Here are a couple of links to the more interesting pages of Eclipse
documentation:</p><ul><li><a href="http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fjface%2Fdialogs%2FDialog.html">Dialogs in Eclipse</a></li><li><a href="http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fcore%2Fresources%2FIMarker.html">IMarker interface</a> (used to check for errors)</li></ul></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://tomregan.github.io/>tomregan.github.io</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>